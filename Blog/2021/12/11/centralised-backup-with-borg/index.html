
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://readthedocs.vinczejanos.info/Blog/2021/12/11/centralised-backup-with-borg/">
      
      
        <link rel="prev" href="../home-assistant-switch-timer-with-tasmota-pulsetime/">
      
      
        <link rel="next" href="../../18/yet-another-article-about-docker-logging-with-fluentd/">
      
      
        
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Centralised Backup With Borg - Vincze Janos Blog</title>
      
    
    
      <link rel="stylesheet" href="../../../../../assets/stylesheets/main.618322db.min.css">
      
        
        <link rel="stylesheet" href="../../../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../../css/width.css">
    
    <script>__md_scope=new URL("../../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#centralised-backup-with-borg" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../../.." title="Vincze Janos Blog" class="md-header__button md-logo" aria-label="Vincze Janos Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vincze Janos Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Centralised Backup With Borg
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="light-green" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/jvincze84/jvincze84.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../../.." title="Vincze Janos Blog" class="md-nav__button md-logo" aria-label="Vincze Janos Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Vincze Janos Blog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/jvincze84/jvincze84.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Welcome Here
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Tips_And_Tricks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tips And Tricks 2024a
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../new-file/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ez egy uj test file
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Blog
  

    
  </span>
  
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Blog
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Templates
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Kubernetes Templates
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/ConfigMap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    ConfigMap
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/Deployment/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Deployments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/Ingress/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Ingress
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/PersistentVolumeClaim/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PersistentVolumeClaim
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/ReverseProxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Kubernetes Reverse Proxy With Ingress, Service And Endpoint
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/Secret/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Secret
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/StatefulSet/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    StatefulSet
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Kubernetes_Templates/services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Old Blog Contents
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Old Blog Contents
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_1" >
        
          
          <label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Linux
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Linux
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/linux/Compile_Apache_Httpd_2.4.x_Php/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compile Apache HTTPD 2.4.X &amp; PHP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/linux/Create_Self_Signed_Certificate_For_Apache_Webserver/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Create Self Signed Certificate For Apache Webserver
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/linux/Install_%28compile%29_%26_Configure_Motion_Av_Tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install (compile) & Configure Motion Av Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/linux/Install_Mps-youtube_Console_Based_Youtube_Player/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install Mps youtube Console Based Youtube Player
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/linux/create_Your_Own_Dyndns_Service_With_Bind_named/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    create Your Own Dyndns Service With Bind named
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Nodemcu
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Nodemcu
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/How_To_Compile_Nodemcu_Firmware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How To Compile Nodemcu Firmware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/How_To_Unbrick_Esp8266_blinking_Blue_Led/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How To Unbrick Esp8266 blinking Blue Led
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/Install_Openalpr_On_Raspberry_Pi_3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install OpenALPR on Raspberry PI 3
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/Logging_Mqtt_Data_%28subscription%29_To_Mysql_With_Shell_Script/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Logging Mqtt Data (subscription) To Mysql With Shell Script
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/Reliable_MQTT_conenction_with_NodeMCU/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reliable MQTT conenction with NodeMCU
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/Reliable_Mqtt_Connection_With_Nodemcu_%28part_2%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reliable Mqtt Connection With Nodemcu (part 2)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/nodemcu/Very_Simple_Way_To_Send_Email_Using_Nodemcu_Firmware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Very Simple Way to Send Email Using NodeMCU firmware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Other
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Other
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/other/Collect_Network_Statistic_With_Telegraf_Vnstat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Collect Network Statistic With Telegraf &amp; VNSTAT
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/other/Iptables_Examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Iptables Examples
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/other/Nokia_6120c_%28bb5%29_Forgotten_Security_Code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Nokia 6120c (BB5) Forgotten Security Code
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/other/Sonoff_Relays_With_Openhab_And_Tasmota_Firmware/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sonoff Relays With OpenHab And Tasmota Firmware
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Raspberry
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Raspberry
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Compile_Go_Language_On_Raspberry_Pi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Compile Go Language On Raspberry Pi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Google_Cloud_Print_With_Orange_Pi_or_Rpi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Google Cloud Print With Orange Pi or Rpi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/How_To_Install_Nodered_On_Raspberry_Pi/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    How To Install Nodered On Raspberry Pi
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Install_Debian_Jessie_To_Orange_Pi_Plus_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install Debian Jessie to Orange PI Plus 2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Install_Openalpr_On_Raspberry_Pi_3_part_2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Install Openalpr On Raspberry Pi 3 part 2
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Mount_Sd_Card_Image_partitioned_Image_Wo_Kpartx/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Mount SD card image (partitioned image) w/o kpartx
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Move_Root_File_System_To_Usb_Storage_%28rpi2_%26_Rpi3%29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Move root file system to USB storage (RPI2 &amp; RPI3)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Raspberry_Pi_2_As_Print_Server_Airprint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Raspberry Pi 2 As Print Server Airprint
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../../Old_Blog_Contents/raspberry/Raspberry_Pi_3_As_Wifi_Range_Extender/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Raspberry Pi 3 As Wifi Range Extender
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tldr" class="md-nav__link">
    <span class="md-ellipsis">
      
        TL;DR
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#installing-borg" class="md-nav__link">
    <span class="md-ellipsis">
      
        Installing Borg
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Installing Borg">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-on-debian-11" class="md-nav__link">
    <span class="md-ellipsis">
      
        Install On Debian 11
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-ssh-and-users" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configure SSH And Users
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-mange-backups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create &amp; Mange Backups
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create &amp; Mange Backups">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#initialize-passphare" class="md-nav__link">
    <span class="md-ellipsis">
      
        Initialize &amp; Passphare
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Initialize &amp; Passphare">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manage-your-key-and-passphrase" class="md-nav__link">
    <span class="md-ellipsis">
      
        Manage Your Key And Passphrase
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#create-backups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Create Backups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-list-backups" class="md-nav__link">
    <span class="md-ellipsis">
      
        Check &amp; List Backups
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#extact-content" class="md-nav__link">
    <span class="md-ellipsis">
      
        Extact Content
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mount-a-backup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mount A Backup
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prune" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prune
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#backup-with-crontab" class="md-nav__link">
    <span class="md-ellipsis">
      
        Backup With Crontab
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#save-backup-to-google-drive" class="md-nav__link">
    <span class="md-ellipsis">
      
        Save Backup To Google Drive
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
  <div class="md-content md-content--post" data-md-component="content">
    <div class="md-sidebar md-sidebar--post" data-md-component="sidebar" data-md-type="navigation">
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner md-post">
          <nav class="md-nav md-nav--primary">
            <div class="md-post__back">
              <div class="md-nav__title md-nav__container">
                <a href="../../../../" class="md-nav__link">
                  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
                  <span class="md-ellipsis">
                    Back to index
                  </span>
                </a>
              </div>
            </div>
            
            <ul class="md-post__meta md-nav__list">
              <li class="md-nav__item md-nav__item--section">
                <div class="md-post__title">
                  <span class="md-ellipsis">
                    Metadata
                  </span>
                </div>
                <nav class="md-nav">
                  <ul class="md-nav__list">
                    <li class="md-nav__item">
                      <div class="md-nav__link">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 19H5V8h14m-3-7v2H8V1H6v2H5c-1.11 0-2 .89-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2h-1V1m-1 11h-5v5h5z"/></svg>
                        <time datetime="2021-12-11 00:00:00+00:00" class="md-ellipsis">December 11, 2021</time>
                      </div>
                    </li>
                    
                    
                    
                      
                      <li class="md-nav__item">
                        <div class="md-nav__link">
                          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20a8 8 0 0 0 8-8 8 8 0 0 0-8-8 8 8 0 0 0-8 8 8 8 0 0 0 8 8m0-18a10 10 0 0 1 10 10 10 10 0 0 1-10 10C6.47 22 2 17.5 2 12A10 10 0 0 1 12 2m.5 5v5.25l4.5 2.67-.75 1.23L11 13V7z"/></svg>
                          <span class="md-ellipsis">
                            
                              9 min read
                            
                          </span>
                        </div>
                      </li>
                    
                  </ul>
                </nav>
              </li>
            </ul>
            
          </nav>
          
        </div>
      </div>
    </div>
    <article class="md-content__inner md-typeset">
      
        
  



  
  


<h1 id="centralised-backup-with-borg">Centralised Backup With Borg<a class="headerlink" href="#centralised-backup-with-borg" title="Permanent link">&para;</a></h1>
<h2 id="tldr">TL;DR<a class="headerlink" href="#tldr" title="Permanent link">&para;</a></h2>
<p>Why I Abandoned Duplicati?</p>
<p>I use to use <a href="https://www.duplicati.com">Duplicati</a> as backup solution for ages. It's a really good backup solution with a handy user interface. Everything can be done on it's interface. </p>
<p>My requirements toward a backup software:</p>
<ul>
<li>Differential backups on daily basis</li>
<li>Support linux operation system</li>
<li>Google Drive support for storing backup remotly</li>
<li>Encryption, of course</li>
<li>Be as lightweight as possible</li>
</ul>
<p>I know Google Drive support a bit unusall, but I have 2TB storage and I don't want to pay for an other service. Duplicati fulfills all my requirments. There are only two weakness because of why I looked for another solution: resource consumption and speed:</p>
<ul>
<li>Duplicati can be really slow on restore from Google Drive if you store a lot of files.</li>
<li>Duplicati uses [Mono](https://www.mono-project.com. (Cross platform, open source .NET framework). Running .NET on linux is not my taste, and sometimes consumes too much resource, especially on a Raspberry PI3.</li>
</ul>
<p>After some hours of Googling and trying some softwares I found <a href="https://borgbackup.readthedocs.io/en/stable/">Borg Backup</a>.</p>
<p>The only missing feature is the Google Drive, but it can be achieved with <code>rclone</code>.</p>
<p>I don't want to write pages about my choice, features, advantages, disadvantages, etc. If you are reading this article you probably want to try or use Borg.</p>
<!-- more -->

<h2 id="installing-borg">Installing Borg<a class="headerlink" href="#installing-borg" title="Permanent link">&para;</a></h2>
<p>I will create three Virtual Machine for demonstration the installation and usage. </p>
<p>Since the borg install procedure is always the same, I've done once and cloned the VM.</p>
<h3 id="install-on-debian-11">Install On Debian 11<a class="headerlink" href="#install-on-debian-11" title="Permanent link">&para;</a></h3>
<p>OS version:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>root@borg01:~# cat /etc/os-release
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>PRETTY_NAME=&quot;Debian GNU/Linux 11 (bullseye)&quot;
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>NAME=&quot;Debian GNU/Linux&quot;
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>VERSION_ID=&quot;11&quot;
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>VERSION=&quot;11 (bullseye)&quot;
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>VERSION_CODENAME=bullseye
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>ID=debian
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>HOME_URL=&quot;https://www.debian.org/&quot;
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>SUPPORT_URL=&quot;https://www.debian.org/support&quot;
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>BUG_REPORT_URL=&quot;https://bugs.debian.org/&quot;
</code></pre></div></td></tr></table></div></p>
<p>Update apt:
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>apt-get<span class="w"> </span>update<span class="w"> </span>--allow-releaseinfo-change
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>apt-get<span class="w"> </span>upgrade
</code></pre></div></p>
<p>Install Borg Backup
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>apt-get<span class="w"> </span>install<span class="w"> </span>borgbackup
</code></pre></div></p>
<p>Check installed version:
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>root@borg01:~#<span class="w"> </span>borg<span class="w"> </span>--version
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>borg<span class="w"> </span><span class="m">1</span>.1.16
</code></pre></div></p>
<p>So now I have a Proxmox template with ID 102. I'm goning to create 3 clone:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>qm<span class="w"> </span>clone<span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">501</span><span class="w"> </span>-full<span class="w"> </span><span class="nb">false</span><span class="w">  </span>-name<span class="w"> </span>borg-01
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>qm<span class="w"> </span>clone<span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">502</span><span class="w"> </span>-full<span class="w"> </span><span class="nb">false</span><span class="w">  </span>-name<span class="w"> </span>borg-02
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>qm<span class="w"> </span>clone<span class="w"> </span><span class="m">102</span><span class="w"> </span><span class="m">503</span><span class="w"> </span>-full<span class="w"> </span><span class="nb">false</span><span class="w">  </span>-name<span class="w"> </span>borg-03
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="c1"># Start </span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>qm<span class="w"> </span>start<span class="w"> </span><span class="m">501</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>qm<span class="w"> </span>start<span class="w"> </span><span class="m">502</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>qm<span class="w"> </span>start<span class="w"> </span><span class="m">503</span>
</code></pre></div>
<p>IP Addresses:</p>
<ul>
<li>borg-01: <code>172.16.1.236/22</code></li>
<li>borg-02: <code>172.16.1.218/22</code></li>
<li>borg-03: <code>172.16.1.219/22</code></li>
</ul>
<h3 id="configure-ssh-and-users">Configure SSH And Users<a class="headerlink" href="#configure-ssh-and-users" title="Permanent link">&para;</a></h3>
<p>The borg-01 will be the server, it will store the backups.</p>
<ul>
<li>
<p>Create User
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Command</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a>useradd<span class="w"> </span>--shell<span class="w"> </span>/bin/bash<span class="w"> </span>--create-home<span class="w">  </span>borg
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>Create SSH keys
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span>
<span class="normal"><a href="#__codelineno-6-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a>su<span class="w"> </span>borg<span class="w"> </span>-s<span class="w"> </span>/bin/bash
<a id="__codelineno-6-2" name="__codelineno-6-2"></a>ssh-keygen
<a id="__codelineno-6-3" name="__codelineno-6-3"></a>cat<span class="w"> </span>~/.ssh/id_rsa.pub<span class="w"> </span>&gt;~/.ssh/authorized_keys
</code></pre></div></td></tr></table></div></p>
</li>
<li>
<p>Distribute the private key accross the other servers.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-7-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-7-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-7-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-7-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-7-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-7-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-7-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-7-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-7-10">10</a></span>
<span class="normal"><a href="#__codelineno-7-11">11</a></span>
<span class="normal"><a href="#__codelineno-7-12">12</a></span>
<span class="normal"><a href="#__codelineno-7-13">13</a></span>
<span class="normal"><a href="#__codelineno-7-14">14</a></span>
<span class="normal"><a href="#__codelineno-7-15">15</a></span>
<span class="normal"><a href="#__codelineno-7-16">16</a></span>
<span class="normal"><a href="#__codelineno-7-17">17</a></span>
<span class="normal"><a href="#__codelineno-7-18">18</a></span>
<span class="normal"><a href="#__codelineno-7-19">19</a></span>
<span class="normal"><a href="#__codelineno-7-20">20</a></span>
<span class="normal"><a href="#__codelineno-7-21">21</a></span>
<span class="normal"><a href="#__codelineno-7-22">22</a></span>
<span class="normal"><a href="#__codelineno-7-23">23</a></span>
<span class="normal"><a href="#__codelineno-7-24">24</a></span>
<span class="normal"><a href="#__codelineno-7-25">25</a></span>
<span class="normal"><a href="#__codelineno-7-26">26</a></span>
<span class="normal"><a href="#__codelineno-7-27">27</a></span>
<span class="normal"><a href="#__codelineno-7-28">28</a></span>
<span class="normal"><a href="#__codelineno-7-29">29</a></span>
<span class="normal"><a href="#__codelineno-7-30">30</a></span>
<span class="normal"><a href="#__codelineno-7-31">31</a></span>
<span class="normal"><a href="#__codelineno-7-32">32</a></span>
<span class="normal"><a href="#__codelineno-7-33">33</a></span>
<span class="normal"><a href="#__codelineno-7-34">34</a></span>
<span class="normal"><a href="#__codelineno-7-35">35</a></span>
<span class="normal"><a href="#__codelineno-7-36">36</a></span>
<span class="normal"><a href="#__codelineno-7-37">37</a></span>
<span class="normal"><a href="#__codelineno-7-38">38</a></span>
<span class="normal"><a href="#__codelineno-7-39">39</a></span>
<span class="normal"><a href="#__codelineno-7-40">40</a></span>
<span class="normal"><a href="#__codelineno-7-41">41</a></span>
<span class="normal"><a href="#__codelineno-7-42">42</a></span>
<span class="normal"><a href="#__codelineno-7-43">43</a></span>
<span class="normal"><a href="#__codelineno-7-44">44</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a>mkdir<span class="w"> </span>.ssh
<a id="__codelineno-7-2" name="__codelineno-7-2"></a>cat<span class="w"> </span><span class="s">&lt;&lt;EOF&gt;~/.ssh/id_rsa</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="s">-----BEGIN OPENSSH PRIVATE KEY-----</span>
<a id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="s">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span>
<a id="__codelineno-7-5" name="__codelineno-7-5"></a><span class="s">NhAAAAAwEAAQAAAYEAoyhZOfPqt61xanxN6tLP9+QDtS/UQhj2o+jmw4xPH2RCYAR9bWde</span>
<a id="__codelineno-7-6" name="__codelineno-7-6"></a><span class="s">S9xVDLL/fvW2aSTwUKQ93ae0Q7e7eyzjBzH9sNab8knIpaiohJefyOgtqptUwN3f3MC8m9</span>
<a id="__codelineno-7-7" name="__codelineno-7-7"></a><span class="s">uHUnBBHTiMG+9BkQ5/luU/VtG10ZLti9LqJaYmq3QFJszu8JGOhWHWDDbt8h08cwefikGJ</span>
<a id="__codelineno-7-8" name="__codelineno-7-8"></a><span class="s">M0KtVCZnMV388QugIO4ecYa1vAdifz82y9m/UbmWkB6NXpnPx1ojciBUnlfTncFxMic+Za</span>
<a id="__codelineno-7-9" name="__codelineno-7-9"></a><span class="s">ZvJsam/XU8hmdG7lSpyTUWRHIm61Zc9iBs90hmvqvDDuiMDu6chWVPiL/+CPT/G9CVprO+</span>
<a id="__codelineno-7-10" name="__codelineno-7-10"></a><span class="s">dfG7mK+pmZgNNezsd5F6uCruhPjd5n17uKU1XgTDOhNmjYrwXCP+455B/NrWGjehjJY3sa</span>
<a id="__codelineno-7-11" name="__codelineno-7-11"></a><span class="s">PNApQrE+XuHw6FQgIRIDH1mLCl1pqZo500M2PXQgj6+nFARpWrM5LrYOvy4ZmYILYEUauC</span>
<a id="__codelineno-7-12" name="__codelineno-7-12"></a><span class="s">cUBpTBkfwqCUKdA3Aq3pAhxqzOzLwLlDxH1F806lAAAFiHUSLjJ1Ei4yAAAAB3NzaC1yc2</span>
<a id="__codelineno-7-13" name="__codelineno-7-13"></a><span class="s">EAAAGBAKMoWTnz6retcWp8TerSz/fkA7Uv1EIY9qPo5sOMTx9kQmAEfW1nXkvcVQyy/371</span>
<a id="__codelineno-7-14" name="__codelineno-7-14"></a><span class="s">tmkk8FCkPd2ntEO3u3ss4wcx/bDWm/JJyKWoqISXn8joLaqbVMDd39zAvJvbh1JwQR04jB</span>
<a id="__codelineno-7-15" name="__codelineno-7-15"></a><span class="s">vvQZEOf5blP1bRtdGS7YvS6iWmJqt0BSbM7vCRjoVh1gw27fIdPHMHn4pBiTNCrVQmZzFd</span>
<a id="__codelineno-7-16" name="__codelineno-7-16"></a><span class="s">/PELoCDuHnGGtbwHYn8/NsvZv1G5lpAejV6Zz8daI3IgVJ5X053BcTInPmWmbybGpv11PI</span>
<a id="__codelineno-7-17" name="__codelineno-7-17"></a><span class="s">ZnRu5Uqck1FkRyJutWXPYgbPdIZr6rww7ojA7unIVlT4i//gj0/xvQlaazvnXxu5ivqZmY</span>
<a id="__codelineno-7-18" name="__codelineno-7-18"></a><span class="s">DTXs7HeRergq7oT43eZ9e7ilNV4EwzoTZo2K8Fwj/uOeQfza1ho3oYyWN7GjzQKUKxPl7h</span>
<a id="__codelineno-7-19" name="__codelineno-7-19"></a><span class="s">8OhUICESAx9ZiwpdaamaOdNDNj10II+vpxQEaVqzOS62Dr8uGZmCC2BFGrgnFAaUwZH8Kg</span>
<a id="__codelineno-7-20" name="__codelineno-7-20"></a><span class="s">lCnQNwKt6QIcaszsy8C5Q8R9RfNOpQAAAAMBAAEAAAGAXcECvK1v08ojoPf64hPvk1d/1e</span>
<a id="__codelineno-7-21" name="__codelineno-7-21"></a><span class="s">68/ppPp9JeQEHw+W3oQjpyRJqgceETMi/tZuwUvIiQWxZ1wlfq2vrKDba2Yl0UlThM9kX1</span>
<a id="__codelineno-7-22" name="__codelineno-7-22"></a><span class="s">uVOYOlDSbWUVULLfWdBlIfnSp5DXSsTcdckXobmzKIJ3SKNE6UOqQdo3DCDPkYDPObh6eV</span>
<a id="__codelineno-7-23" name="__codelineno-7-23"></a><span class="s">hLeQt7JSQaFny98GFiagsYXx7XkxAef3tt0s1aWry+cA3EiqHI7loj/FC70Rm3uWN2pCwa</span>
<a id="__codelineno-7-24" name="__codelineno-7-24"></a><span class="s">OiESZ1Bhi+QOG8sF++G6mczyVc4/Ij/L47uWM7HGYy+kZxMi8eLW8SWCDGKCjOAxK7F3G3</span>
<a id="__codelineno-7-25" name="__codelineno-7-25"></a><span class="s">N80I362y+ZeTO4ab73hGAukhjJb1SJRf0iWm8sgULRvdqxzEnRJuCzHZhoTErbNRqx4Rtz</span>
<a id="__codelineno-7-26" name="__codelineno-7-26"></a><span class="s">val38czH4vhFT1H2pGyJQiLt2u+77kuCY+opKfb/YE4tsj1R8zT4MIUoui7OEPZ9KWsTPh</span>
<a id="__codelineno-7-27" name="__codelineno-7-27"></a><span class="s">M53Fs+pAedKXUHCC+54AWUVhp49PQSDmFH1Wm5CtJVc4HOifsf1k7gwegGYGvIbqiFAAAA</span>
<a id="__codelineno-7-28" name="__codelineno-7-28"></a><span class="s">wQCpz7o80lVgaobV4xXlf6vsshIm/f1Jp6gppGv72N+w5xqQqvEs3saBMnJ9BrD56M8cac</span>
<a id="__codelineno-7-29" name="__codelineno-7-29"></a><span class="s">p2UzPL2DS4n/ZIi9EivTSGVCp9S6MVUFrbZRITEOKYXeQ14dJfkWBaB3876f5Ll++ougoO</span>
<a id="__codelineno-7-30" name="__codelineno-7-30"></a><span class="s">XzJeVo9HJuy27/US2B58jlMF3UA+HAVfPlpwdPx8NPmBDd69GLzB/s/rOmn1ZTsSMzu7x6</span>
<a id="__codelineno-7-31" name="__codelineno-7-31"></a><span class="s">igQnqiy+06XRhx4T1cSbGDH24lY6WH23SXikSt2+HX7KXdgTMAAADBANd/gnJqPVYuOlNJ</span>
<a id="__codelineno-7-32" name="__codelineno-7-32"></a><span class="s">Yj/lBmmHd8pgdy6HSpguCVsD7XJjCQpv4N1NEq+xhdONeN/gFzlVKlf38o3W6vpfPR//Q1</span>
<a id="__codelineno-7-33" name="__codelineno-7-33"></a><span class="s">u7Wud70XAijZpDDha190/9HhMCPqbJ3PY0HxniiMz4HHg5Gca9tYX4DezB3AoUmVh9F3oQ</span>
<a id="__codelineno-7-34" name="__codelineno-7-34"></a><span class="s">PRO+RO3TMKdh5n3h8YVwCQ0qJvbWALqpyh6Fc2vO9j9pc+GNDGn/ViWXeZt2uyrnj6HE6K</span>
<a id="__codelineno-7-35" name="__codelineno-7-35"></a><span class="s">3Mbvn+WZ85Ygbmvijca7Dm72dAyoKyuwAAAMEAwdKGkz0j0I/YOu9YcQXNp+YLUU/aRHox</span>
<a id="__codelineno-7-36" name="__codelineno-7-36"></a><span class="s">wODjABbpJfBKM6l3VstV/uohu7egN5LZxQRiDk4Y75OtfR9SI5459qMzZP6vK3xxVcJso2</span>
<a id="__codelineno-7-37" name="__codelineno-7-37"></a><span class="s">hrBz14DUhBt3R/akOfhF9PW2vasuhK2WOrMrYwBkkMxDcP1u66CVRHzlC5jX+uzBfPF7cI</span>
<a id="__codelineno-7-38" name="__codelineno-7-38"></a><span class="s">FWP1EjNXMttHN5/t1NBs/Mj78Rgr+Rdzm//3dvWW1Z7ME/YVldTIBTCbP3/2Z9hHTO+FmR</span>
<a id="__codelineno-7-39" name="__codelineno-7-39"></a><span class="s">EmVgLE4QudDV4fAAAADGJvcmdAYm9yZy0wMQECAwQFBg==</span>
<a id="__codelineno-7-40" name="__codelineno-7-40"></a><span class="s">-----END OPENSSH PRIVATE KEY-----</span>
<a id="__codelineno-7-41" name="__codelineno-7-41"></a><span class="s">EOF</span>
<a id="__codelineno-7-42" name="__codelineno-7-42"></a>
<a id="__codelineno-7-43" name="__codelineno-7-43"></a>chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>~/.ssh/
<a id="__codelineno-7-44" name="__codelineno-7-44"></a>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>~/.ssh/id_rsa
</code></pre></div></td></tr></table></div></p>
</li>
</ul>
<p>Test:
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>ssh<span class="w"> </span>borg@172.16.1.215
</code></pre></div></p>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Linux borg-01 5.13.19-1-pve #1 SMP PVE 5.13.19-2 (Tue, 09 Nov 2021 12:59:38 +0100) x86_64
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>The programs included with the Debian GNU/Linux system are free software;
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>the exact distribution terms for each program are described in the
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>individual files in /usr/share/doc/*/copyright.
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>permitted by applicable law.
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>Last login: Sat Dec 11 15:51:46 2021 from 172.16.1.216
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>borg@borg-01:~$
</code></pre></div>
<p>Ok. It works well.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please keep your private key safe. Since this is a demo environment I don't care much the security. I storngly recommend to use individual keys for each host. This post is not about ssh key management, but Borg backup.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>I'm using the <code>root</code> user on the clients, bacuse only the <code>root</code> account has access to the directories I want to backup.</p>
</div>
<h2 id="create-mange-backups">Create &amp; Mange Backups<a class="headerlink" href="#create-mange-backups" title="Permanent link">&para;</a></h2>
<h3 id="initialize-passphare">Initialize &amp; Passphare<a class="headerlink" href="#initialize-passphare" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>Create very strong passphare
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>head<span class="w"> </span>-c<span class="w"> </span><span class="m">32</span><span class="w"> </span>/dev/urandom<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-w<span class="w"> </span><span class="m">0</span><span class="w"> </span>&gt;<span class="w"> </span>~/.borg-passphrase
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>chmod<span class="w"> </span><span class="m">400</span><span class="w"> </span>~/.borg-passphrase
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="nb">export</span><span class="w"> </span><span class="nv">BORG_PASSCOMMAND</span><span class="o">=</span><span class="s2">&quot;cat </span><span class="nv">$HOME</span><span class="s2">/.borg-passphrase&quot;</span>
</code></pre></div></p>
</li>
<li>
<p>Initialize
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Command</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a>borg<span class="w"> </span>init<span class="w"> </span>-e<span class="w"> </span>repokey-blake2<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02
</code></pre></div></td></tr></table></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>By default repositories initialized with this version will produce security
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>errors if written to with an older version (up to and including Borg 1.0.8).
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>If you want to use these older versions, you can disable the check by running:
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>borg upgrade --disable-tam ssh://borg@172.16.1.236/home/borg/borg-02
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>See https://borgbackup.readthedocs.io/en/stable/changes.html#pre-1-0-9-manifest-spoofing-vulnerability for details about the security implications.
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>IMPORTANT: you will need both KEY AND PASSPHRASE to access this repo!
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>Use &quot;borg key export&quot; to export the key, optionally in printable format.
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>Write down the passphrase. Store both at safe place(s). 
</code></pre></div></p>
</li>
</ul>
<div class="admonition caution">
<p class="admonition-title">Caution</p>
<p>If you lose the passphrase (<code>~/.borg-passphrase</code>) you lose all of the backups, as well. So I do really recommend to keep it in a safe place, not just in the home directory!</p>
</div>
<p>Repeat this step on all nodes you want to create backup.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There are two really important things to be kept in safe, the passphrase  and the key. I strongly recommend to save them to you password manager or keep them somewhere in really safe. </p>
</div>
<h4 id="manage-your-key-and-passphrase">Manage Your Key And Passphrase<a class="headerlink" href="#manage-your-key-and-passphrase" title="Permanent link">&para;</a></h4>
<p>I assume you are using password manager in any way, and hope this manager is not a plain text file. :) </p>
<p>Save your passphrase to your password manager is simple. Just save the conent of this file: <code>~/.borg-passphrase</code>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>cat<span class="w"> </span>~/.borg-passphrase<span class="w">  </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span>
</code></pre></div>
The key is bit more complicated. Fisrt see how to export:</p>
<p><div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Command</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a>borg<span class="w"> </span>key<span class="w"> </span><span class="nb">export</span><span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02<span class="w">  </span>/tmp/key
<a id="__codelineno-14-2" name="__codelineno-14-2"></a>cat<span class="w"> </span>/tmp/key
</code></pre></div></td></tr></table></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>BORG_KEY f968c50460d1ca7aaec9a8e2347a61fd286b26fb84adcaa6de7808966026b51e
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>hqlhbGdvcml0aG2mc2hhMjU2pGRhdGHaAZ7vhs+Yzwxg9VgXxo95S5+ScE8RT3yY6elK5J
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>KJKhfwz/YYJrGO6ZlDSpr9i+fnUI7qz6BfIxBLA6yILdcFVpOUuy99cDp79Uyc7wrIDnTV
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>sk0oiQWBt3710yM3hJQC84Q69grriPrF0jdzgSCvDKn+FNfQQgLTgnYMavxxnXZESTStng
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>zfxMtcJZMghEm1Mfd8ZwRTDXPgpF5z03bXy+7DrQ/btxgiW8G+h6DEccBDKvf0oAfDOPvH
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>sGgC2aBq+lqpUcxdIhpd+CZ0BzFkWCMrQkr3QOhlMbGtkqi7a78/rIYeJWevyWwODM7RvZ
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>i01qqbrDoflkRAg/LiY76p0wi46ls8Annygw9RY7YzOq7+xEvImGRYXX5joJ9Lb1GQ3Eh1
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>7MSFFdVRfAXbcAUlyQXZ+k/TzxZIFw7ZsXvQL33AFD1MwuXVJdXCJZFtWNUD97Cd5cTwEq
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a>f6T5AofjK6WAIF5qD4RGVEoH0X8+7MJ6IHCu8aPbjnqVLvjR9Ubii7mS5gC9IRdaN5T61i
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>PjNC3Lm8TjqL8WlSjqfqvu2BczikaGFzaNoAIL0XSOEvCdQ46MtJO5/Q98J1mEDsC9tLVv
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>OBZZy+emXAqml0ZXJhdGlvbnPOAAGGoKRzYWx02gAg/tXk5wRp5YZlOHdzm+Gk+8f5Qi/f
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>s2VHKZJPL8BfecWndmVyc2lvbgE=
</code></pre></div></p>
<p>If you can save this file as attachment  you are done. But not all password manager supports attachments, and the line brakes can be broken. In this case I recommend to use <code>base64</code>:</p>
<p><div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>cat<span class="w"> </span>/tmp/key<span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-w0<span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nb">echo</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>Qk9SR19LRVkgZjk2OGM1MDQ2MGQxY2E3YWFlYzlhOGUyMzQ3YTYxZmQyODZiMjZmYjg0YWRjYWE2ZGU3ODA4OTY2MDI2YjUxZQpocWxoYkdkdmNtbDBhRzJtYzJoaE1qVTJwR1JoZEdIYUFaN3ZocytZend4ZzlWZ1h4bzk1UzUrU2NFOFJUM3lZNmVsSzVKCktKS2hmd3ovWVlKckdPNlpsRFNwcjlpK2ZuVUk3cXo2QmZJeEJMQTZ5SUxkY0ZWcE9VdXk5OWNEcDc5VXljN3dySURuVFYKc2swb2lRV0J0MzcxMHlNM2hKUUM4NFE2OWdycmlQckYwamR6Z1NDdkRLbitGTmZRUWdMVGduWU1hdnh4blhaRVNUU3RuZwp6ZnhNdGNKWk1naEVtMU1mZDhad1JURFhQZ3BGNXowM2JYeSs3RHJRL2J0eGdpVzhHK2g2REVjY0JES3ZmMG9BZkRPUHZICnNHZ0MyYUJxK2xxcFVjeGRJaHBkK0NaMEJ6RmtXQ01yUWtyM1FPaGxNYkd0a3FpN2E3OC9ySVllSldldnlXd09ETTdSdloKaTAxcXFickRvZmxrUkFnL0xpWTc2cDB3aTQ2bHM4QW5ueWd3OVJZN1l6T3E3K3hFdkltR1JZWFg1am9KOUxiMUdRM0VoMQo3TVNGRmRWUmZBWGJjQVVseVFYWitrL1R6eFpJRnc3WnNYdlFMMzNBRkQxTXd1WFZKZFhDSlpGdFdOVUQ5N0NkNWNUd0VxCmY2VDVBb2ZqSzZXQUlGNXFENFJHVkVvSDBYOCs3TUo2SUhDdThhUGJqbnFWTHZqUjlVYmlpN21TNWdDOUlSZGFONVQ2MWkKUGpOQzNMbThUanFMOFdsU2pxZnF2dTJCY3ppa2FHRnphTm9BSUwwWFNPRXZDZFE0Nk10Sk81L1E5OEoxbUVEc0M5dExWdgpPQlpaeStlbVhBcW1sMFpYSmhkR2x2Ym5QT0FBR0dvS1J6WVd4MDJnQWcvdFhrNXdScDVZWmxPSGR6bStHays4ZjVRaS9mCnMyVkhLWkpQTDhCZmVjV25kbVZ5YzJsdmJnRT0K
</code></pre></div></p>
<p>Restore command: <code>echo -n [BASE64_STRING] | base64 -d</code></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want to make the <code>base64</code> string smaller you can use <code>gzip</code>.<br />
<strong>Encode</strong>: <code>cat /tmp/key | gzip -c | base64</code><br />
<strong>Decode</strong>: <code>echo -n [BASE64_STRING] | base64 -d | gunzip -c</code></p>
</div>
<h3 id="create-backups">Create Backups<a class="headerlink" href="#create-backups" title="Permanent link">&para;</a></h3>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Don't forget to export <code>BORG_PASSCOMMAND</code>  before you use <code>borg</code> command!<br />
<code>export BORG_PASSCOMMAND="cat $HOME/.borg-passphrase"</code></p>
</div>
<p><div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>borg<span class="w"> </span>create<span class="w"> </span>--stats<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02::firstBackup<span class="w"> </span>/root<span class="w"> </span>/etc<span class="w"> </span>/home<span class="w"> </span>/opt
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>------------------------------------------------------------------------------
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Archive name: firstBackup
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>Archive fingerprint: 882ed726a7115928149aa438af4b78f09d322a34c17dd65f0bf7ce537092ee1b
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a>Time (start): Sat, 2021-12-11 17:43:09
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>Time (end):   Sat, 2021-12-11 17:43:11
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>Duration: 2.40 seconds
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a>Number of files: 443
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>Utilization of max. archive size: 0%
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>------------------------------------------------------------------------------
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>                       Original size      Compressed size    Deduplicated size
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>This archive:                1.61 MB            654.41 kB            649.83 kB
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a>All archives:                1.61 MB            654.41 kB            649.83 kB
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>                       Unique chunks         Total chunks
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>Chunk index:                     424                  434
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a>------------------------------------------------------------------------------
</code></pre></div></p>
<p>Create another backup:</p>
<p><div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>borg<span class="w"> </span>create<span class="w"> </span>--stats<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02::secondBackup<span class="w"> </span>/root<span class="w"> </span>/etc<span class="w"> </span>/home<span class="w"> </span>/opt<span class="w"> </span>/var/log/
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>------------------------------------------------------------------------------
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>Archive name: secondBackup
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>Archive fingerprint: f61a6d2ce46fc6433a6cfa9cdb1f146933f897c6bce769d071644e7117684cd9
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>Time (start): Sat, 2021-12-11 17:44:53
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>Time (end):   Sat, 2021-12-11 17:44:55
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>Duration: 1.56 seconds
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>Number of files: 470
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>Utilization of max. archive size: 0%
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a>------------------------------------------------------------------------------
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>                       Original size      Compressed size    Deduplicated size
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>This archive:               51.16 MB              8.95 MB              8.35 MB
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>All archives:               52.77 MB              9.60 MB              9.00 MB
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>                       Unique chunks         Total chunks
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>Chunk index:                     458                  898
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a>------------------------------------------------------------------------------
</code></pre></div></p>
<h3 id="check-list-backups">Check &amp; List Backups<a class="headerlink" href="#check-list-backups" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p>List Backups 
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>borg<span class="w"> </span>list<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>firstBackup                          Sat, 2021-12-11 17:43:09 [882ed726a7115928149aa438af4b78f09d322a34c17dd65f0bf7ce537092ee1b]
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>secondBackup                         Sat, 2021-12-11 17:44:53 [f61a6d2ce46fc6433a6cfa9cdb1f146933f897c6bce769d071644e7117684cd9]
</code></pre></div></p>
</li>
<li>
<p>Check The Conent Of A Backup
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>borg<span class="w"> </span>list<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02::secondBackup
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>drwx------ root   root          0 Sat, 2021-12-11 17:36:41 root
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>-rw-r--r-- root   root        161 Tue, 2019-07-09 12:05:50 root/.profile
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>-rw-r--r-- root   root        571 Sat, 2021-04-10 22:00:00 root/.bashrc
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>-rw------- root   root        273 Sat, 2021-12-11 17:21:55 root/.bash_history
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>drwx------ root   root          0 Sat, 2021-12-11 17:26:32 root/.ssh
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>-rw------- root   root       2602 Sat, 2021-12-11 17:25:59 root/.ssh/id_rsa
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>-rw-r--r-- root   root        222 Sat, 2021-12-11 17:26:32 root/.ssh/known_hosts
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>...
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>...
</code></pre></div></p>
</li>
</ul>
<h3 id="extact-content">Extact Content<a class="headerlink" href="#extact-content" title="Permanent link">&para;</a></h3>
<p>For example we want to restore the home direcrory from the <code>secondBackup</code>.
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="nb">cd</span><span class="w"> </span>/tmp
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>mkdir<span class="w"> </span>restore
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="nb">cd</span><span class="w"> </span>restore
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>borg<span class="w"> </span>extract<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02::secondBackup<span class="w"> </span>home
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>find
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>.
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>./home
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>./home/user
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>./home/user/.bash_history
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>./home/user/.bash_logout
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>./home/user/.bashrc
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>./home/user/.profile 
</code></pre></div></p>
<p>Borg has a really lovely feature: you can mount any of your backup.</p>
<h3 id="mount-a-backup">Mount A Backup<a class="headerlink" href="#mount-a-backup" title="Permanent link">&para;</a></h3>
<p>Command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>borg<span class="w"> </span>mount<span class="w"> </span>borg@172.16.1.236:/home/borg/borg-02::secondBackup<span class="w"> </span>/mnt
</code></pre></div></p>
<p>Check:
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="nb">cd</span><span class="w"> </span>/mnt/
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>ls<span class="w"> </span>-la
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>total 4
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>drwxr-xr-x  1 root root    0 Dec 11 18:01 .
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>drwxr-xr-x 18 root root 4096 Nov 21 13:38 ..
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>drwxr-xr-x  1 root root    0 Dec 11 17:43 etc
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a>drwxr-xr-x  1 root root    0 Nov 21 13:42 home
<a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a>drwxr-xr-x  1 root root    0 Nov 21 13:35 opt
<a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a>drwx------  1 root root    0 Dec 11 17:36 root
<a id="__codelineno-30-8" name="__codelineno-30-8" href="#__codelineno-30-8"></a>drwxr-xr-x  1 root root    0 Dec 11 18:01 var 
</code></pre></div></p>
<p>You can browse inside the backup and restore any file you want. </p>
<p>If you don't need the mount anymore, don't forget to unmount:
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>borg<span class="w"> </span>umount<span class="w"> </span>/mnt
</code></pre></div></p>
<h3 id="prune">Prune<a class="headerlink" href="#prune" title="Permanent link">&para;</a></h3>
<p>Assume that you create backups every day. Probably you don't need every backup forever. You can prue your repository and keep only certain amount of backup. For example I use the following parameters to prune the repository:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>borg<span class="w"> </span>prune<span class="w">  </span>--stats<span class="w"> </span>--keep-daily<span class="w"> </span><span class="m">3</span><span class="w"> </span>--keep-weekly<span class="w"> </span><span class="m">2</span><span class="w">  </span>--keep-monthly<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="si">${</span><span class="nv">REPO_PATH</span><span class="si">}</span>
</code></pre></div>
<p>This will keep 3 daily backup, 2 weekly and 5 monthly. What does it mean? Example:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>Weekly 2:  2021-11-28T02:00:01                  Sun, 2021-11-28 02:00:03 [c1c349e361dc5f..... ]
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>Monthly 1: 2021-11-30T02:00:01                  Tue, 2021-11-30 02:00:03 [a83f0b4d9d686f..... ]
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>Weekly 1:  2021-12-05T02:00:01                  Sun, 2021-12-05 02:00:04 [39980ab7451c33..... ]
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>Daily 3:   2021-12-09T02:00:01                  Thu, 2021-12-09 02:00:02 [daf1c1ea020b16..... ]
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>Daily 2:   2021-12-10T02:00:01                  Fri, 2021-12-10 02:00:03 [dd6fee702f0593..... ]
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>Daily 1:   2021-12-11T02:00:01                  Sat, 2021-12-11 02:00:03 [e0385e46a1e968..... ]
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>My script creates backup on every day at 02:00am.</p>
</div>
<ul>
<li><code>keep-daily</code> --&gt; keeps the last backup of each day. </li>
<li><code>keep-weekly</code> --&gt; keeps the last backup from the last <code>n</code> Sunday</li>
<li><code>keep-monthly</code> --&gt; keeps the last backup from the last day of the month</li>
</ul>
<p>Read more: <a href="https://borgbackup.readthedocs.io/en/stable/usage/prune.html">https://borgbackup.readthedocs.io/en/stable/usage/prune.html</a></p>
<h2 id="backup-with-crontab">Backup With Crontab<a class="headerlink" href="#backup-with-crontab" title="Permanent link">&para;</a></h2>
<p>I have a little shell script to automatize my daily backup:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="ch">#!/bin/bash</span>
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="nb">exec</span><span class="w"> </span>&gt;<span class="w"> </span>&gt;<span class="o">(</span>logger<span class="w"> </span>-i<span class="w"> </span>--tag<span class="w"> </span>borgbackup<span class="o">)</span><span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>
<a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="nb">export</span><span class="w"> </span><span class="nv">BORG_PASSCOMMAND</span><span class="o">=</span><span class="s2">&quot;cat </span><span class="nv">$HOME</span><span class="s2">/.borg-passphrase&quot;</span>
<a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="nv">REPO_PATH</span><span class="o">=</span><span class="s2">&quot;borg@172.16.1.236:/home/borg/borg-02&quot;</span>
<a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="nv">REPO_BCK_DATE</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>date<span class="w"> </span>+%FT%T<span class="k">)</span><span class="s2">&quot;</span>
<a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a><span class="nv">BACKUPS</span><span class="o">=</span><span class="s2">&quot;/etc/ /opt/ /home/ /root&quot;</span>
<a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>
<a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;==================== Creating Backup ====================&quot;</span>
<a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a>borg<span class="w"> </span>create<span class="w"> </span>--stats<span class="w"> </span><span class="si">${</span><span class="nv">REPO_PATH</span><span class="si">}</span>::<span class="si">${</span><span class="nv">REPO_BCK_DATE</span><span class="si">}</span><span class="w"> </span><span class="si">${</span><span class="nv">BACKUPS</span><span class="si">}</span>
<a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;==================== Prune ====================&quot;</span>
<a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>borg<span class="w"> </span>prune<span class="w">  </span>--stats<span class="w"> </span>--keep-daily<span class="w"> </span><span class="m">3</span><span class="w"> </span>--keep-weekly<span class="w"> </span><span class="m">2</span><span class="w">  </span>--keep-monthly<span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="si">${</span><span class="nv">REPO_PATH</span><span class="si">}</span>
<a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;==================== List ====================&quot;</span>
<a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>borg<span class="w"> </span>list<span class="w"> </span><span class="si">${</span><span class="nv">REPO_PATH</span><span class="si">}</span>
</code></pre></div>
<p>This script write logs to the <code>syslog</code>:</p>
<div class="highlight"><span class="filename">Command</span><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>cat<span class="w"> </span>/var/log/syslog<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="s1">&#39;borgbackup&#39;</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output</span><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>Dec 11 18:23:56 borg-02 borgbackup[4557]: ==================== Creating Backup ====================
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: ------------------------------------------------------------------------------
<a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Archive name: 2021-12-11T18:23:56
<a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Archive fingerprint: d8be120187e55f630cd4816b3879b2aae83f262a00336c3d20bd62da96dce7fa
<a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Time (start): Sat, 2021-12-11 18:23:56
<a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Time (end):   Sat, 2021-12-11 18:23:57
<a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Duration: 0.37 seconds
<a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Number of files: 444
<a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Utilization of max. archive size: 0%
<a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: ------------------------------------------------------------------------------
<a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]:                        Original size      Compressed size    Deduplicated size
<a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: This archive:                1.61 MB            654.31 kB             53.47 kB
<a id="__codelineno-36-13" name="__codelineno-36-13" href="#__codelineno-36-13"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: All archives:                3.22 MB              1.31 MB            703.21 kB
<a id="__codelineno-36-14" name="__codelineno-36-14" href="#__codelineno-36-14"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]:
<a id="__codelineno-36-15" name="__codelineno-36-15" href="#__codelineno-36-15"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]:                        Unique chunks         Total chunks
<a id="__codelineno-36-16" name="__codelineno-36-16" href="#__codelineno-36-16"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: Chunk index:                     430                  870
<a id="__codelineno-36-17" name="__codelineno-36-17" href="#__codelineno-36-17"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: ------------------------------------------------------------------------------
<a id="__codelineno-36-18" name="__codelineno-36-18" href="#__codelineno-36-18"></a>Dec 11 18:23:58 borg-02 borgbackup[4557]: ==================== Prune ====================
<a id="__codelineno-36-19" name="__codelineno-36-19" href="#__codelineno-36-19"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: ------------------------------------------------------------------------------
<a id="__codelineno-36-20" name="__codelineno-36-20" href="#__codelineno-36-20"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]:                        Original size      Compressed size    Deduplicated size
<a id="__codelineno-36-21" name="__codelineno-36-21" href="#__codelineno-36-21"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: Deleted data:               -1.61 MB           -654.32 kB            -53.48 kB
<a id="__codelineno-36-22" name="__codelineno-36-22" href="#__codelineno-36-22"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: All archives:                1.61 MB            654.31 kB            649.73 kB
<a id="__codelineno-36-23" name="__codelineno-36-23" href="#__codelineno-36-23"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]:
<a id="__codelineno-36-24" name="__codelineno-36-24" href="#__codelineno-36-24"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]:                        Unique chunks         Total chunks
<a id="__codelineno-36-25" name="__codelineno-36-25" href="#__codelineno-36-25"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: Chunk index:                     425                  435
<a id="__codelineno-36-26" name="__codelineno-36-26" href="#__codelineno-36-26"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: ------------------------------------------------------------------------------
<a id="__codelineno-36-27" name="__codelineno-36-27" href="#__codelineno-36-27"></a>Dec 11 18:24:00 borg-02 borgbackup[4557]: ==================== List ====================
<a id="__codelineno-36-28" name="__codelineno-36-28" href="#__codelineno-36-28"></a>Dec 11 18:24:01 borg-02 borgbackup[4557]: 2021-12-11T18:23:56                  Sat, 2021-12-11 18:23:56 [d8be120187e55f630cd4816b3879b2aae83f262a00336c3d20bd62da96dce7fa]
</code></pre></div>
<p>You can schedule this script using <code>crontab</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>0       2       *       *       *       /root/do-backup.sh
</code></pre></div>
<h2 id="save-backup-to-google-drive">Save Backup To Google Drive<a class="headerlink" href="#save-backup-to-google-drive" title="Permanent link">&para;</a></h2>
<p>As I mentioned early in this article, one of my important goal is to save my backups to Google Drive. I did not bother too much with this. There is an excellent tool for linux: <a href="https://rclone.org">Rclone</a></p>
<p>After configuring <code>rclone</code> you can upload the backups to Google Dirve from your central Borg server. Example command:
<div class="highlight"><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>rclone<span class="w"> </span>sync<span class="w"> </span>-P<span class="w"> </span>/home/borg/<span class="w"> </span>gdrive:/borgbackup
</code></pre></div></p>
<div class="admonition quote">
<p class="admonition-title">Quote</p>
<p>Sync the source to the destination, changing the destination
only.  Doesn't transfer unchanged files, testing by size and
modification time or MD5SUM.  Destination is updated to match
source, including deleting files if necessary.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Since all of the backups are encrypted we don't need to bother with extra encryption or password protection. </p>
</div>
<p>There are two disadvantages over Duplicati from my point of view: </p>
<ul>
<li>This way we store the backup twice. (On the Borg central server and Google Drive)</li>
<li>We need a running Borg Server. <ul>
<li>This can be avoided. You can create local backups and upload them individually from the hosts.</li>
</ul>
</li>
</ul>
<hr />
<p><strong>Thank you for reading!</strong>  I don't know if this post was useful for you or not, but I think giving more and more examples is always helpful.</p>







  
  




  


<script src="https://giscus.app/client.js"
        data-repo="jvincze84/jvincze84.github.io"
        data-repo-id="R_kgDOGJolJg"
        data-category-id="DIC_kwDOGJolJs4CPryr"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="bottom"
        data-theme="transparent_dark"
        data-lang="en"
        crossorigin="anonymous"
        async>
</script>
      
    </article>
  </div>

          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <!-- Cookie Consent by https://www.CookieConsent.com -->
<script type="text/javascript" src="//www.cookieconsent.com/releases/4.0.0/cookie-consent.js" charset="UTF-8"></script>
<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({"notice_banner_type":"headline","consent_type":"express","palette":"light","language":"en","page_load_consent_levels":["strictly-necessary"],"notice_banner_reject_button_hide":false,"preferences_center_close_button_hide":false,"website_name":"Blog"});
});
</script>

<noscript>ePrivacy and GPDR Cookie Consent by <a href="https://www.CookieConsent.com/" rel="nofollow noopener">Cookie Consent</a></noscript>
<!-- End Cookie Consent by https://www.CookieConsent.com -->

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../../../..", "features": ["navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "search.highlight", "header.autohide", "content.code.annotate", "content.code.copy"], "search": "../../../../../assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../../../assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>